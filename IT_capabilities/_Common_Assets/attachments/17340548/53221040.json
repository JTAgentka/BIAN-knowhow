{
  "$schema": "https://json-schema.org/draft-07/schema",
  "$id": "https://acmark.com/jtb/BankAccountTopicSchema.json",
  "description": "CRM BankAccount Schema",
  "type": "object",
  "required": [
    "state",
    "timestamp",
    "bankAccountId"
  ],
  "properties": {
    "X-Correlation-ID": {
      "type": [
        "string",
        "null"
      ],
      "description": "Korelační identifikátor pro inicializaci a rekonciliaci"
    },
    "action": {
      "description": "Typ operace. NULL pro rekonciliaci/inicializaci.",
      "anyOf": [
        {
          "type": "string",
          "enum": [
            "create",
            "update",
            "delete"
          ]
        },
        {
          "type": "null"
        }
      ]
    },
    "timestamp": {
      "description": "Datum a čas operace",
      "type": "string",
      "format": "date-time"
    },
    "bankAccountId": {
      "description": "Interní CRM GUID primární klíč, vždy vyplněno",
      "type": "string"
    },
    "before": {
      "description": "Stav záznamu před provedením změn. NULL při vytvoření záznamu a při rekonciliaci/inicializaci.",
      "oneOf": [
        {
          "type": "null"
        },
        {
          "$ref": "#/definitions/BankAccountData"
        }
      ]
    },
    "after": {
      "description": "Stav záznamu po provedení změn. NULL při smazání záznamu.",
      "oneOf": [
        {
          "type": "null"
        },
        {
          "$ref": "#/definitions/BankAccountData"
        }
      ]
    },
    "state": {
      "description": "Technický stav záznamu",
      "type": "object",
      "required": [
        "statecode",
        "statuscode",
        "anonymized",
        "deleted",
        "merged"
      ],
      "properties": {
        "statecode": {
          "description": "Statecode",
          "type": "object",
          "required": [
            "value",
            "label"
          ],
          "properties": {
            "value": {
              "description": "Hodnota CRM enumerátoru/OptionSetu",
              "type": "integer",
              "examples": [
                0,
                1
              ]
            },
            "label": {
              "description": "Popisek číselníkové hodnoty z CRM",
              "type": "string",
              "examples": [
                "Aktivní",
                "Neaktivní"
              ]
            }
          }
        },
        "statuscode": {
          "description": "Statuscode",
          "type": "object",
          "required": [
            "value",
            "label"
          ],
          "properties": {
            "value": {
              "description": "Hodnota CRM enumerátoru/OptionSetu",
              "type": "integer",
              "examples": [
                1,
                2
              ]
            },
            "label": {
              "description": "Popisek číselníkové hodnoty z CRM",
              "type": "string",
              "examples": [
                "Aktivní",
                "Neaktivní"
              ]
            }
          }
        },
        "anonymized": {
          "description": "Záznam byl anonymizován",
          "type": [
            "boolean"
          ]
        },
        "deleted": {
          "description": "Záznam byl smazán",
          "type": [
            "boolean"
          ]
        },
        "merged": {
          "description": "Záznam byl sloučen a deaktivován",
          "type": [
            "boolean"
          ]
        },
        "masterid": {
          "description": "GUID vítězného záznamu při slučování",
          "type": [
            "string",
            "null"
          ],
          "format": "uuid"
        }
      }
    }
  },
  "definitions": {
    "BankAccountData": {
      "type": "object",
      "required": [
        "accountId",
        "currency"
      ],
      "properties": {
        "accountId": {
          "type": "string",
          "format": "uuid",
          "description": "Klient/firma (GUID klienta/firmy v CRM)"
        },
        "klientId": {
          "description": "Klient ID (KLID)",
          "type": [
            "string",
            "null"
          ],
          "examples": [
            1000018856
          ]
        },
        "contractId": {
          "oneOf": [
            {
              "type": "null"
            },
            {
              "type": "string",
              "format": "uuid"
            }
          ],
          "description": "Smlouva (GUID smlouvy v CRM)"
        },
        "portfolioKid": {
          "description": "KID portfolia",
          "type": [
            "string",
            "null"
          ],
          "examples": [
            "10000001"
          ]
        },
        "accountNumber":{
          "description": "Číslo účtu, bez kódu banky",
          "type": [
            "string",
            "null"
          ],
          "examples": [
            "10000001"
          ]
        },
        "bankCode":{
          "description": "Kód banky",
          "type": [
            "string",
            "null"
          ],
          "examples": [
            "5800"
          ]
        },
        "iban":{
          "description": "Číslo účtu ve formátu IBAN.",
          "type": [
            "string",
            "null"
          ],
          "examples": [
            "CZ36 0100 0000 0001 2345 6789"
          ]
        },
        "specificSymbol":{
          "description": "Specifický symbol.",
          "type": [
            "string",
            "null"
          ],
          "examples": [
            "CZ36 0100 0000 0001 2345 6789"
          ]
        },
        "bic":{
          "description": "Zahraniční spojení/BIC kód.",
          "type": [
            "string",
            "null"
          ],
          "examples": [
            "JTBPCZPP"
          ]
        },
        "order":{
          "description": "Pořadí.",
          "type": [
            "integer",
            "null"
          ],
          "examples": [
            1, 2
          ]
        },
        "variableSymbol":{
          "description": "Variabilní symbol.",
          "type": [
            "string",
            "null"
          ],
          "examples": [
            1234
          ]
        },
        "description":{
          "description": "Popis.",
          "type": [
            "string",
            "null"
          ],
          "examples": [
            "Textarea"
          ]
        },
        "validFrom": {
          "description": "Platnost od",
          "type": [
            "string",
            "null"
          ],
          "format": "date-time"
        },
        "validTo": {
          "description": "Platnost do",
          "type": [
            "string",
            "null"
          ],
          "format": "date-time"
        },
        "currency": {
          "type": "string",
          "description": "Měna (apicode)",
          "examples": [
            "CZK",
            "EUR",
            "USD"
          ]
        },        
        "bankAccountKind": {
          "description": "Druh účtu",
          "anyOf": [
            {
              "type": "object",
              "required": [
                "value",
                "label"
              ],
              "properties": {
                "value": {
                  "description": "Hodnota CRM enumerátoru/OptionSetu",
                  "type": "integer",
                  "examples": [
                    500000000
                  ]
                },
                "label": {
                  "description": "Popisek číselníkové hodnoty z CRM",
                  "type": "string",
                  "examples": [
                    "T - Tuzemský",
                    "Z - Zahraniční"
                  ]
                }
              }
            },
            {
              "type": "null"
            }
          ]
        },      
        "bankAccountType": {
          "description": "Lokace",
          "anyOf": [
            {
              "type": "object",
              "required": [
                "value",
                "label"
              ],
              "properties": {
                "value": {
                  "description": "Hodnota CRM enumerátoru/OptionSetu",
                  "type": "integer",
                  "examples": [
                    500000000
                  ]
                },
                "label": {
                  "description": "Popisek číselníkové hodnoty z CRM",
                  "type": "string",
                  "examples": [
                    "Autorizovaný účet - investování",
                    "Účet pro výplatu kupónu dluhopisu",
                    "Účet pro výplatu provizí ZPR",
                    "Účet pro ověřovací platbu",
                    "Autorizovaný účet - Minty",
                    "Ostatní"
                  ]
                }
              }
            },
            {
              "type": "null"
            }
          ]
        }
      }
    }
  }
  
}