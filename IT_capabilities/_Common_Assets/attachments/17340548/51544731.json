{
  "$schema": "https://json-schema.org/draft-07/schema",
  "description": "CRM ContactPerson Schema",
  "type": "object",
  "required": [
    "timestamp",
    "contactPersonId",
    "after",
    "state"
  ],
  "properties": {
    "X-Correlation-ID": {
      "type": [
        "string",
        "null"
      ],
      "description": "Correlation identifier for initialization and reconciliation"
    },
    "action": {
      "description": "Operation type. NULL for reconciliation/init.",
      "anyOf": [
        {
          "type": "string",
          "enum": [
            "create",
            "update",
            "delete"
          ]
        },
        {
          "type": "null"
        }
      ]
    },
    "timestamp": {
      "description": "Date and tipe of operation",
      "type": "string",
      "format": "date-time"
    },
    "contactPersonId": {
      "description": "Unique contact person identifier.",
      "type": "string"
    },
    "before": {
      "description": "State of the record before changes. NULL - in case of creating / reconciliation / initialization.",
      "oneOf": [
        {
          "type": "null"
        },
        {
          "$ref": "#/definitions/ContactPersonData"
        }
      ]
    },
    "after": {
      "description": "State of the record after changes. ",
      "$ref": "#/definitions/ContactPersonData"

    },
    "state": {
      "description": "Technical state of record.",
      "type": "object",
      "required": [
        "statecode",
        "statuscode",
        "anonymized",
        "deleted",
        "merged"
      ],
      "properties": {
        "statecode": {
          "description": "Statecode",
          "type": "object",
          "required": [
            "value",
            "label"
          ],
          "properties": {
            "value": {
              "description": "CRM enumerator/OptionSet",
              "type": "integer",
              "examples": [
                0,
                1
              ]
            },
            "label": {
              "description": "Description of codebook value from CRM",
              "type": "string",
              "examples": [
                "Aktivní",
                "Neaktivní"
              ]
            }
          }
        },
        "statuscode": {
          "description": "Statuscode",
          "type": "object",
          "required": [
            "value",
            "label"
          ],
          "properties": {
            "value": {
              "description": "CRM enumerator/OptionSet",
              "type": "integer",
              "examples": [
                1,
                2
              ]
            },
            "label": {
              "description": "Description of codebook value from CRM",
              "type": "string",
              "examples": [
                "Aktivní",
                "Neaktivní"
              ]
            }
          }
        },
        "anonymized": {
          "description": "Record was anonymized",
          "type": [
            "boolean"
          ]
        },
        "deleted": {
          "description": "Record was deleted",
          "type": [
            "boolean"
          ]
        },
        "merged": {
          "description": "Record was merged and deactivated",
          "type": [
            "boolean"
          ]
        },
        "masterid": {
          "description": "GUID primary record from merging",
          "type": [
            "string",
            "null"
          ],
          "format": "uuid"
        }
      }
    }
  },
  "definitions": {
    "ContactPersonData": {
      "type": "object",
      "required": [
        "contactPersonName"
      ],
      "properties": {
        "contactPersonName": {
          "type": "string",
          "minLength": 2,
          "maxLength": 100,
          "description": "Name or identification of person."
        },
        "contactPersonDomainLogin": {
          "description": "Person domain name.",
          "type": [
            "string",
            "null"
          ],
          "examples": [
            "JTBA\\JT8100008"
          ]
        },
        "username": {
          "description": "Username",
          "type": [
            "string",
            "null"
          ],
          "minLength": 2,
          "maxLength": 200,
          "examples": [
            "10000001"
          ]
        }
      }
    }
  }
}