{
  "title": "PortfolioValuationDaily",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "Portfolio valuation daily",
  "type": "object",
  "required": [
    "portfolioIds",
    "validityDate",
    "businessChangeDate",
    "status",
    "pfCurrency"
  ],
  "properties": {
    "X-Correlation-ID": {
      "type": [
        "string",
        "null"
      ],
      "title": "X-Correlation-ID",
      "description": "Korelační identifikátor, povinné pro INIT a RECON"
    },
    "portfolioIds": {
      "type": "object",
      "description": "Identifkátory portfolia",
      "$ref": "#/definitions/portfolioIds"
    },
    "validityDate": {
      "description": "Datum platnosti oceněného stavu portfolia",
      "type": "string",
      "format": "date"
    },
    "businessChangeDate": {
      "description": "Datum a čas poslední změny entity",
      "type": "string",
      "format": "date-time"
    },
    "status": {
      "description": "Reflektuje stav fyzické existence záznamu: active - aktivní, deleted - samzáno",
      "type": "string",
      "enum": [
        "active",
        "deleted"
      ]
    },
    "pfCurrency": {
      "description": "Měna portfolia. ISO 4217 abecední kód (3 znaky). Číselník Currencies.",
      "type": "string"
    },
    "instrumentPositions": {
      "type": [
        "array",
        "null"
      ],
      "description": "Kolekce oceněných pozic CP v portfoliu",
      "items": {
        "type": "object",
        "required": [
          "instrumentIds",
          "positionCode",
          "depositoryAccTypeId",
          "instrumentCurrency",
          "tradedPosition",
          "settledPosition"
        ],
        "properties": {
          "instrumentIds": {
            "type": "object",
            "description": "Identifikátory CP",
            "$ref": "#/definitions/instrumentIds"
          },
          "positionCode": {
            "description": "Pozice: A - Aktiva, C - Cross Currency Swap, D - Deriváty, J - CP Přijaté jako zajištění, K - Kapitál, L - Listinné CP, P - Pasiva, R - Reverzní REPO, T - Termínovaný vklad, V - Vlastní, Z - REPO",
            "type": "string",
            "enum": [
              "A",
              "C",
              "D",
              "J",
              "K",
              "L",
              "P",
              "R",
              "T",
              "V",
              "Z"
            ]
          },
          "depositoryAccTypeId": {
            "description": "Apl kód depozitáře z číselníku DepositoryAccType. Zdroj: Apl_Kod Sloupce stavu CP - eBroker.Sl_Stavu_CP.Apl_Kod",
            "type": "string"
          },
          "instrumentCurrency": {
            "description": "Měna obchodování CP - ISO 4217 abecední kód (3 znaky). Číselník Currencies.",
            "type": "string"
          },
          "tradedPosition": {
            "type": "object",
            "description": "Oceněná zobchodovaná pozice CP v portfoliu",
            "$ref": "#/definitions/portfolioInstrumentPositionValued"
          },
          "settledPosition": {
            "type": "object",
            "description": "Oceněná vypořádaná pozice CP v portfoliu",
            "$ref": "#/definitions/portfolioInstrumentPositionValued"
          }
        }
      }
    },
    "collAccountPositions": {
      "type": [
        "array",
        "null"
      ],
      "description": "Kolekce oceněných pozic CP v portfoliu",
      "items": {
        "type": "object",
        "required": [
          "collAccountIds",
          "accCurrency",
          "blockedAmount",
          "unsettledBalance",
          "presettledBalance",
          "settledBalance"
        ],
        "properties": {
          "collAccountIds": {
            "type": "object",
            "description": "IDs sběrného účtu",
            "$ref": "#/definitions/collAccountIds"
          },
          "accCurrency": {
            "description": "Měna účtu. ISO 4217 abecední kód (3 znaky). Číselník Currencies.",
            "type": "string"
          },
          "blockedAmount": {
            "type": "object",
            "description": "Objem peněz blokovaných aktivními Pokyny (aktuálně pouze TA)",
            "$ref": "#/definitions/portfolioCollAccountValue"
          },
          "unsettledBalance": {
            "type": "object",
            "description": "Zobchodovaný zůstatek",
            "$ref": "#/definitions/portfolioCollAccountValue"
          },
          "presettledBalance": {
            "type": "object",
            "description": "Předvypořádaný zůstatek (vypořádaný plus očekávané vypořádání)",
            "$ref": "#/definitions/portfolioCollAccountValue"
          },
          "settledBalance": {
            "type": "object",
            "description": "Vypořádaný zůstatek",
            "$ref": "#/definitions/portfolioCollAccountValue"
          }
        }
      }
    }
  },
  "definitions": {
    "portfolioIds": {
      "description": "Identifkátory portfolia",
      "type": "object",
      "required": [
        "ebrokerId",
        "topasId"
      ],
      "properties": {
        "ebrokerId": {
          "type": "integer",
          "description": "Identifikace portfolia v eBroker"
        },
        "topasId": {
          "type": "integer",
          "description": "Identifikace portfolia v TOPAS (KID)"
        },
        "taId": {
          "type": [
            "integer",
            "null"
          ],
          "description": "Identifikace účtu podílníka v TA"
        }
      }
    },
    "instrumentIds": {
      "description": "Identifikátory CP",
      "type": "object",
      "required": [
        "ccpId",
        "ebrokerId"
      ],
      "properties": {
        "ccpId": {
          "type": "integer",
          "description": "Identifikace CP v CCP."
        },
        "ebrokerId": {
          "type": "integer",
          "description": "Identifikace CP v eBroker"
        },
        "topasId": {
          "type": [
            "integer",
            "null"
          ],
          "description": "Identifikace CP v TOPAS"
        },
        "taId": {
          "type": [
            "integer",
            "null"
          ],
          "description": "Identifikace CP v TA"
        }
      }
    },
    "portfolioInstrumentPositionValued": {
      "description": "Oceněná zobchodovaná pozice CP v portfoliu",
      "type": "object",
      "required": [
        "quantity",
        "acquisitionPriceInstrCurrency",
        "acquisitionPricePfCurrency",
        "acquisitionPriceCZK",
        "acquisitionPriceEUR",
        "acquisitionPriceUSD",
        "valuePriceInstrCurrency",
        "valuePricePfCurrency",
        "valuePriceCZK",
        "valuePriceEUR",
        "valuePriceUSD"
      ],
      "properties": {
        "quantity": {
          "type": "number",
          "description": "Počet kusů CP v pozici"
        },
        "acquisitionPriceInstrCurrency": {
          "type": "object",
          "description": "Celková pořizovací cena pozice v Měně obchodování CP",
          "$ref": "#/definitions/portfolioInstrumentPositionAcquisitionPrice"
        },
        "acquisitionPricePfCurrency": {
          "type": "object",
          "description": "Celková pořizovací cena pozice v Měně portfolia",
          "$ref": "#/definitions/portfolioInstrumentPositionAcquisitionPrice"
        },
        "acquisitionPriceCZK": {
          "type": "object",
          "description": "Celková pořizovací cena pozice v CZK",
          "$ref": "#/definitions/portfolioInstrumentPositionAcquisitionPrice"
        },
        "acquisitionPriceEUR": {
          "type": "object",
          "description": "Celková pořizovací cena pozice v EUR",
          "$ref": "#/definitions/portfolioInstrumentPositionAcquisitionPrice"
        },
        "acquisitionPriceUSD": {
          "type": "object",
          "description": "Celková pořizovací cena pozice v USD",
          "$ref": "#/definitions/portfolioInstrumentPositionAcquisitionPrice"
        },
        "valuePriceInstrCurrency": {
          "type": "object",
          "description": "Celková oceňovací cena pozice v Měně obchodování CP",
          "$ref": "#/definitions/portfolioInstrumentPositionValuePrice"
        },
        "valuePricePfCurrency": {
          "type": "object",
          "description": "Celková oceňovací cena pozice v Měně portfolia",
          "$ref": "#/definitions/portfolioInstrumentPositionValuePrice"
        },
        "valuePriceCZK": {
          "type": "object",
          "description": "Celková oceňovací cena pozice v CZK",
          "$ref": "#/definitions/portfolioInstrumentPositionValuePrice"
        },
        "valuePriceEUR": {
          "type": "object",
          "description": "Celková oceňovací cena pozice v EUR",
          "$ref": "#/definitions/portfolioInstrumentPositionValuePrice"
        },
        "valuePriceUSD": {
          "type": "object",
          "description": "Celková oceňovací cena pozice v USD",
          "$ref": "#/definitions/portfolioInstrumentPositionValuePrice"
        }
      }
    },
    "portfolioInstrumentPositionAcquisitionPrice": {
      "type": "object",
      "description": "Celková pořizovací cena pozice v Měně obchodování CP",
      "required": [
        "gross",
        "net",
        "aI"
      ],
      "properties": {
        "gross": {
          "type": "number",
          "description": "Celková pořizovací cena jistiny s poplatky (při otevření pozice)"
        },
        "net": {
          "type": "number",
          "description": "Celková pořizovací cena jistiny bez poplatků (při otevření pozice)"
        },
        "aI": {
          "type": "number",
          "description": "Celkové pořizovací AÚV"
        }
      }
    },
    "portfolioInstrumentPositionValuePrice": {
      "type": "object",
      "description": "Celková pořizovací cena pozice v Měně obchodování CP",
      "properties": {
        "principal": {
          "type": [
            "number",
            "null"
          ],
          "description": "Celková oceňovací cena jistiny"
        },
        "aI": {
          "type": [
            "number",
            "null"
          ],
          "description": "Celkové oceňovací AÚV"
        }
      }
    },
    "collAccountIds": {
      "description": "Identifikátory sběrného účtu",
      "type": "object",
      "required": [
        "ebrokerId",
        "topasId",
        "taId",
        "accountNumber",
        "bankCode",
        "iban"
      ],
      "properties": {
        "ebrokerId": {
          "type": "integer",
          "description": "ID sběrného účtu v eBroker"
        },
        "topasId": {
          "type": "integer",
          "description": "ID sběrného účtu v Topas (Cenný papír Topas)"
        },
        "taId": {
          "type": "integer",
          "description": "ID sběrného účtu v TA (Platební místo FEIS)"
        },
        "accountNumberPrefix": {
          "description": "Předčíslí SÚ dle BBAN formátu",
          "type": [
            "string",
            "null"
          ],
          "maxLength": 6
        },
        "accountNumber": {
          "description": "Hlavní část SÚ dle BBAN formátu",
          "type": "string",
          "maxLength": 10
        },
        "bankCode": {
          "description": "Kód banky SÚ dle BBAN formátu",
          "type": "string",
          "maxLength": 4
        },
        "iban": {
          "type": "string",
          "maxlength": 34,
          "description": "SÚ v IBAN formátu"
        }
      }
    },
    "portfolioCollAccountValue": {
      "type": "object",
      "required": [
        "valueAccCurrency",
        "valuePfCurrency",
        "valueCZK",
        "valueEUR",
        "valueUSD"
      ],
      "properties": {
        "valueAccCurrency": {
          "type": "number",
          "description": "Hodnota v Měně účtu"
        },
        "valuePfCurrency": {
          "type": "number",
          "description": "Hodnota v Měně portfolia"
        },
        "valueCZK": {
          "type": "number",
          "description": "Hodnota v CZK"
        },
        "valueEUR": {
          "type": "number",
          "description": "Hodnota v EUR"
        },
        "valueUSD": {
          "type": "number",
          "description": "Hodnota v USD"
        }
      }
    }
  }
}