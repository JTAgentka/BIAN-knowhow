{
  "$schema": "https://json-schema.org/draft-07/schema",
  "$id": "http://acmark.com/jtb/ActivityMeetingRecordSchema.json",
  "description": "CRM Meeting Record Activity Schema",
  "type": "object",
  "required": [
    "activityIds",
    "timestamp",
    "meetingRecordData",
    "state"
  ],
  "properties": {
    "X-Correlation-ID": {
      "type": [
        "string",
        "null"
      ],
      "description": "Korelační identifikátor pro inicializaci a rekonciliaci"
    },
    "activityIds": {
      "type": "object",
      "properties": {
        "crmActivityId": {
          "type": "string",
          "format": "uuid",
          "description": "Interní CRM GUID primární klíč, vždy vyplněno"
        },
        "dcActivityId": {
          "type": [
            "string",
            "null"
          ],
          "description": "Identifikátor aktivity v digitálních kanálech"
        }
      },
      "required": ["crmActivityId"],
      "description": "Objekt s identifikátory aktivity"
    },
    "action": {
      "description": "Typ operace. NULL pro rekonciliaci/inicializaci.",
      "anyOf": [
        {
          "type": "string",
          "enum": [
            "create",
            "update",
            "delete"
          ]
        },
        {"type": "null"}
      ]
    },
    "timestamp": {
      "description": "Datum a čas operace",
      "type": "string",
      "format": "date-time"
    },
    "meetingRecordData": {
      "description": "Data záznamu z jednání",
      "type": "object",
      "required": [
        "accountIds",
        "ownerId",
        "location",
        "meetingPurpose",
        "documentsHandedOver",
        "otherInformation",
        "meetingLocation",
        "attendees"
      ],
      "properties": {
        "accountIds": {
          "description": "Klient",
          "$ref": "#/definitions/EntityReference"
        },
        "ownerId": {
          "type": "string",
          "description": "Vlastník aktivity (bankéř, apicode)",
          "examples": ["JTBA\\JT8100008"]
        },
        "location": {
          "description": "Lokace, v současnosti se používá pouze CZ.",
          "type": "object",
          "required": [
            "value",
            "label"
          ],
          "properties": {
            "value": {
              "description": "Hodnota CRM enumerátoru/OptionSetu",
              "type": "integer",
              "examples": [500000000]
            },
            "label": {
              "description": "Popisek číselníkové hodnoty z CRM",
              "type": "string",
              "examples": [
                "CZ",
                "SK",
                "CZ i SK"
              ]
            }
          }
        },
        "subject": {
          "description": "Předmět",
          "type": [
            "string",
            "null"
          ]
        },
        "companyRepresentatives": {
          "description": "Osoby zastupující klienta. Pouze pro PO.",
          "oneOf": [
            {"type": "null"},
            {"$ref": "#/definitions/CompanyRepresentativesSection"}
          ]
        },
        "meetingPurpose": {
          "description": "Účel jednání",
          "$ref": "#/definitions/MeetingPurposeSection"
        },
        "documentsHandedOver": {
          "description": "Předané informace nebo dokumenty",
          "$ref": "#/definitions/DocumentsHandedOverSection"
        },
        "otherInformation": {
          "description": "Ostatní informace",
          "$ref": "#/definitions/OtherInformationSection"
        },
        "meetingLocation": {
          "description": "Místo konání",
          "$ref": "#/definitions/MeetingLocationSection"
        },
        "attendees": {
          "description": "Účastníci",
          "$ref": "#/definitions/AttendeesSection"
        },
        "bankersNote": {
          "description": "Další komentář - poznámka bankéře (není zobrazeno na výsledném PDF)",
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "state": {
      "description": "Technický stav záznamu",
      "type": "object",
      "required": [
        "statecode",
        "statuscode"
      ],
      "properties": {
        "statecode": {
          "description": "Statecode",
          "type": "object",
          "required": [
            "value",
            "label"
          ],
          "properties": {
            "value": {
              "description": "Hodnota CRM enumerátoru/OptionSetu",
              "type": "integer",
              "examples": [
                0,
                1
              ]
            },
            "label": {
              "description": "Popisek číselníkové hodnoty z CRM",
              "type": "string",
              "examples": [
                "Aktivní",
                "Neaktivní"
              ]
            }
          }
        },
        "statuscode": {
          "description": "Statuscode",
          "type": "object",
          "required": [
            "value",
            "label"
          ],
          "properties": {
            "value": {
              "description": "Hodnota CRM enumerátoru/OptionSetu",
              "type": "integer",
              "examples": [
                1,
                2
              ]
            },
            "label": {
              "description": "Popisek číselníkové hodnoty z CRM",
              "type": "string",
              "examples": [
                "Aktivní",
                "Neaktivní"
              ]
            }
          }
        },
        "anonymized": {
          "description": "Záznam byl anonymizován",
          "type": "boolean"
        },
        "deleted": {
          "description": "Záznam byl smazán",
          "type": "boolean"
        },
        "merged": {
          "description": "Záznam byl sloučen a deaktivován",
          "type": "boolean"
        },
        "masterid": {
          "description": "GUID vítězného záznamu při slučování",
          "type": [
            "string",
            "null"
          ],
          "format": "uuid"
        }
      }
    }
  },
  "definitions": {
    "EntityReference": {
      "type": [
        "object",
        "null"
      ],
      "required": [
        "idValue",
        "idType"
      ],
      "properties": {
        "idValue": {
          "type": "string",
          "format": "uuid",
          "description": "GUID záznamu v CRM."
        },
        "idType": {
          "type": "string",
          "enum": [
            "account",
            "contact",
            "systemuser"
          ],
          "description": "Typ návazného záznamu v CRM."
        },
        "crmId": {
          "type": [
            "string",
            "null"
          ],
          "description": "KLID záznamu, je-li k dispozici."
        },
        "name": {
          "type": [
            "string",
            "null"
          ],
          "description": "Název (label) záznamu v CRM."
        }
      },
      "description": "Informace o návazném záznamu."
    },
    "CompanyRepresentative": {
      "description": "Zástupce klienta. Může být ID kontaktu v CRM nebo celé jméno a RČ jako string.",
      "type": "object",
      "properties": {
        "contactIds": {
          "description": "Zástupce za klienta PO, kontakt z CRM.",
          "oneOf": [
            {"type": "null"},
            {"$ref": "#/definitions/EntityReference"}
          ]
        },
        "fullName": {
          "description": "Jméno a příjmení",
          "type": [
            "string",
            "null"
          ]
        },
        "birthNumber": {
          "description": "Rodné číslo",
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "CompanyRepresentativesSection": {
      "description": "Osoby zastupující klienta. Pouze pro PO.",
      "type": "object",
      "properties": {
        "representative1": {
          "description": "První zástupce PO",
          "$ref": "#/definitions/CompanyRepresentative"
        },
        "representative2": {
          "description": "Druhý zástupce PO",
          "$ref": "#/definitions/CompanyRepresentative"
        }
      }
    },
    "MeetingPurposeSection": {
      "description": "Účel jednání",
      "type": "object",
      "required": [
        "potencialClient",
        "contractMaintenance",
        "advertisement",
        "personalInfoDisclaimer",
        "investmentQuestionnaire",
        "tradeInstructions",
        "outOfMarketTradeInstructions",
        "productMaintenance",
        "creditCard",
        "portfolioReview",
        "investmentAdvisory",
        "otherPurpose"
      ],
      "properties": {
        "potencialClient": {
          "description": "Jednání s potenciálním klientem",
          "type": "boolean"
        },
        "contractMaintenance": {
          "description": "Navázání nebo správa smluvního vztahu",
          "type": "boolean"
        },
        "advertisement": {
          "description": "Informování o službách a produktech poskytovaných J&T Bankou",
          "type": "boolean"
        },
        "personalInfoDisclaimer": {
          "description": "Informování o zpracování osobních údajů klienta",
          "type": "boolean"
        },
        "investmentQuestionnaire": {
          "description": "Vyplnění/aktualizace Investičního dotazníku",
          "type": "boolean"
        },
        "tradeInstructions": {
          "description": "Přijetí pokynu k obchodu (v souladu s cílovým trhem)",
          "type": "boolean"
        },
        "outOfMarketTradeInstructions": {
          "description": "Přijetí pokynu k obchodu (mimo cílový trh)",
          "type": "boolean"
        },
        "productMaintenance": {
          "description": "Správa bankovních produktů",
          "type": "boolean"
        },
        "creditCard": {
          "description": "Platební karta",
          "type": "boolean"
        },
        "portfolioReview": {
          "description": "Roční review",
          "type": "boolean"
        },
        "investmentAdvisory": {
          "description": "Investiční poradenství",
          "type": "boolean"
        },
        "otherPurpose": {
          "description": "Jiný účel",
          "type": "boolean"
        },
        "otherPurposeNote": {
          "description": "Jiný účel - poznámka",
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "DocumentsHandedOverSection": {
      "description": "Předané informace nebo dokumenty",
      "type": "object",
      "required": [
        "bankInfo",
        "investmentQuestionnaireInfo",
        "propertyStatusInfo",
        "bankProductsInfo",
        "investmentProductsInfo",
        "lesserInvestmentProductsInfo",
        "investmentOutsideMarketInfo",
        "providedPropertyInfo",
        "investmentAdvisoryRequest",
        "investmentAdvisoryModeling",
        "investmentAdvisoryList",
        "investmentAdvisoryInstructions",
        "otherDocuments"
      ],
      "properties": {
        "bankInfo": {
          "description": "Informace o J&T Bance",
          "type": "boolean"
        },
        "investmentQuestionnaireInfo": {
          "description": "Investiční dotazník, vč. AML informací",
          "type": "boolean"
        },
        "propertyStatusInfo": {
          "description": "Informace o stavu majetku v J&T Bance",
          "type": "boolean"
        },
        "bankProductsInfo": {
          "description": "Informace k bankovním produktům",
          "type": "boolean"
        },
        "investmentProductsInfo": {
          "description": "Informace k investičním produktům",
          "type": "boolean"
        },
        "lesserInvestmentProductsInfo": {
          "description": "Informace o investičních produktech s nižší likviditou",
          "type": "boolean"
        },
        "investmentOutsideMarketInfo": {
          "description": "Informace k investici mimo cílový trh klienta",
          "type": "boolean"
        },
        "providedPropertyInfo": {
          "description": "Informace o celkovém majetku klienta",
          "type": "boolean"
        },
        "investmentAdvisoryRequest": {
          "description": "Žádost o IP",
          "type": "boolean"
        },
        "investmentAdvisoryModeling": {
          "description": "Návrh modelace IP",
          "type": "boolean"
        },
        "investmentAdvisoryList": {
          "description": "Modelace IP",
          "type": "boolean"
        },
        "investmentAdvisoryInstructions": {
          "description": "Podání pokynů v rámci IP",
          "type": "boolean"
        },
        "otherDocuments": {
          "description": "Jiné dokumenty",
          "type": "boolean"
        },
        "otherDocumentsNote": {
          "description": "Jiné dokumenty - poznámka",
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "OtherInformationSection": {
      "description": "Ostatní informace",
      "type": "object",
      "required": [
        "meetingInitiatedBy",
        "meetingDate",
        "filledOnPaperForm",
        "isCopy"
      ],
      "properties": {
        "meetingInitiatedBy": {
          "description": "Schůzku inicioval. 0 = Klient, 1 = Bankéř",
          "type": "boolean"
        },
        "meetingDate": {
          "description": "Datum konání",
          "type": "string",
          "format": "date-time"
        },
        "filledOnPaperForm": {
          "description": "Záznam vyplněn papírově",
          "type": "boolean"
        },
        "isCopy": {
          "description": "Oprava/kopie",
          "type": "boolean"
        },
        "sentOn": {
          "description": "Datum odeslání",
          "type": [
            "string",
            "null"
          ],
          "format": "date-time"
        }
      }
    },
    "MeetingLocationSection": {
      "description": "Místo konání",
      "type": "object",
      "required": [
        "pragueJtb",
        "brnoJtb",
        "ostravaJtb",
        "outsideJtb"
      ],
      "properties": {
        "pragueJtb": {
          "description": "JTBA Praha",
          "type": "boolean"
        },
        "brnoJtb": {
          "description": "JTBA Brno",
          "type": "boolean"
        },
        "ostravaJtb": {
          "description": "JTBA Ostrava",
          "type": "boolean"
        },
        "outsideJtb": {
          "description": "Mimo JTBA",
          "type": "boolean"
        },
        "outsideJtbNote": {
          "description": "Mimo JTBA - poznámka",
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "AttendeesSection": {
      "description": "Účastníci",
      "type": "object",
      "required": [
        "clientRepresentative1",
        "bankRepresentative1",
        "bankRepresentative1Email"
      ],
      "properties": {
        "clientRepresentative1": {
          "description": "Jméno zástupce klienta 1",
          "type": "string"
        },
        "clientRepresentative2": {
          "description": "Jméno zástupce klienta 2 (nepovinný)",
          "type": [
            "string",
            "null"
          ]
        },
        "bankRepresentative1": {
          "type": "string",
          "description": "Zástupce banky (bankéř, apicode)",
          "examples": ["JTBA\\JT8100008"]
        },
        "bankRepresentative1Email": {
          "type": "string",
          "description": "E-mail zástupce banky"
        },
        "bankRepresentative2": {
          "type": [
            "string",
            "null"
          ],
          "description": "Jméno druhého zástupce banky"
        }
      }
    }
  }
}