{
  "$schema": "https://json-schema.org/draft-07/schema",
  "$id": "http://acmark.com/jtb/ActivityPhonecallSchema.json",
  "description": "CRM Phonecall Activity Schema",
  "type": "object",
  "required": [
    "activityIds",
    "timestamp",
    "phonecallData",
    "state"
  ],
  "properties": {
    "X-Correlation-ID": {
      "type": [
        "string",
        "null"
      ],
      "description": "Korelační identifikátor pro inicializaci a rekonciliaci"
    },
    "activityIds": {
      "type": "object",
      "properties": {
        "crmActivityId": {
          "type": "string",
          "format": "uuid",
          "description": "Interní CRM GUID primární klíč, vždy vyplněno"
        },
        "dcActivityId": {
          "type": [
            "string",
            "null"
          ],
          "description": "Identifikátor aktivity v digitálních kanálech"
        }
      },
      "required": ["crmActivityId"],
      "description": "Objekt s identifikátory aktivity"
    },
    "action": {
      "description": "Typ operace. NULL pro rekonciliaci/inicializaci.",
      "anyOf": [
        {
          "type": "string",
          "enum": [
            "create",
            "update",
            "delete"
          ]
        },
        {"type": "null"}
      ]
    },
    "timestamp": {
      "description": "Datum a čas operace",
      "type": "string",
      "format": "date-time"
    },
    "phonecallData": {
      "description": "Data telefonního hovoru",
      "type": "object",
      "required": [
        "subject",
        "scheduledEnd",
        "ownerId",
        "directionCode"
      ],
      "properties": {
        "subject": {
          "description": "Předmět telefonního hovoru",
          "type": "string"
        },
        "regardingObjectIds": {
          "description": "Identifikace záznamu, kterého se aktivita týká.",
          "oneOf": [
            {"type": "null"},
            {"$ref": "#/definitions/EntityReference"}
          ]
        },
        "ownerId": {
          "type": "string",
          "description": "Vlastník aktivity (bankéř, apicode)",
          "examples": ["JTBA\\JT8100008"]
        },
        "scheduledEnd": {
          "description": "Termín splnění",
          "type": "string",
          "format": "date-time"
        },
        "actualDurationMinutes": {
          "description": "Doba trvání",
          "type": [
            "integer",
            "null"
          ]
        },
        "directionCode": {
          "description": "Směr, false = příchozí, true = odchozí",
          "type": "boolean"
        },
        "phonenumber": {
          "description": "Telefonní číslo",
          "type": [
            "string",
            "null"
          ]
        },
        "phonecallResult": {
          "description": "Výsledek zpracování hovoru",
          "type": [
            "string",
            "null"
          ]
        },
        "feedback": {
          "description": "Zpětná vazba",
          "anyOf": [
            {
              "type": "object",
              "required": [
                "value",
                "label"
              ],
              "properties": {
                "value": {
                  "description": "Hodnota CRM enumerátoru/OptionSetu",
                  "type": "integer",
                  "examples": [
                    500000000,
                    500000001,
                    500000002,
                    500000003
                  ]
                },
                "label": {
                  "description": "Popisek číselníkové hodnoty z CRM",
                  "type": "string",
                  "examples": [
                    "PB schůzka",
                    "PRB schůzka",
                    "Jiné služby",
                    "Nemá zájem"
                  ]
                }
              }
            },
            {"type": "null"}
          ]
        },
        "disinterestReason": {
          "description": "Důvod nezájmu",
          "anyOf": [
            {
              "type": "object",
              "required": [
                "value",
                "label"
              ],
              "properties": {
                "value": {
                  "description": "Hodnota CRM enumerátoru/OptionSetu",
                  "type": "integer",
                  "examples": [
                    500000000,
                    500000001,
                    500000002,
                    500000003,
                    500000004,
                    500000005,
                    500000006,
                    500000007,
                    500000008,
                    500000009
                  ]
                },
                "label": {
                  "description": "Popisek číselníkové hodnoty z CRM",
                  "type": "string",
                  "examples": [
                    "jednalo se o dočasné uložení volných prostředků / plánuji peníze použít jiným způsobem",
                    "našel/a jsem jiný TV s vyšším úrokem",
                    "nedůvěřuji JT Bance",
                    "špatné služby JT Banky / konkurence nabízí lepší služby",
                    "prostě nemám zájem",
                    "nedokážu využít služby OB/PB",
                    "nemám dostatek prostředků",
                    "nechci mít příliš mnoho prostředků v jedné bance",
                    "nevím / nemám konkrétní důvod",
                    "jiné"
                  ]
                }
              }
            },
            {"type": "null"}
          ]
        },
        "disinterestDescription": {
          "description": "Popis nezájmu",
          "type": [
            "string",
            "null"
          ]
        },
        "from": {
          "description": "Identifikace volajícího.",
          "oneOf": [
            {"type": "null"},
            {"$ref": "#/definitions/EntityReference"}
          ]
        },
        "to": {
          "description": "Identifikace volaného.",
          "oneOf": [
            {"type": "null"},
            {"$ref": "#/definitions/EntityReference"}
          ]
        },
        "phonecallRecordUrl": {
          "description": "URL nahrávky hovoru",
          "type": [
            "string",
            "null"
          ]
        },
        "communicationHistoryUrl": {
          "description": "URL komunikační historie",
          "type": [
            "string",
            "null"
          ]
        },
        "description": {
          "description": "Popis",
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "state": {
      "description": "Technický stav záznamu",
      "type": "object",
      "required": [
        "statecode",
        "statuscode"
      ],
      "properties": {
        "statecode": {
          "description": "Statecode",
          "type": "object",
          "required": [
            "value",
            "label"
          ],
          "properties": {
            "value": {
              "description": "Hodnota CRM enumerátoru/OptionSetu",
              "type": "integer",
              "examples": [
                0,
                1
              ]
            },
            "label": {
              "description": "Popisek číselníkové hodnoty z CRM",
              "type": "string",
              "examples": [
                "Aktivní",
                "Neaktivní"
              ]
            }
          }
        },
        "statuscode": {
          "description": "Statuscode",
          "type": "object",
          "required": [
            "value",
            "label"
          ],
          "properties": {
            "value": {
              "description": "Hodnota CRM enumerátoru/OptionSetu",
              "type": "integer",
              "examples": [
                1,
                2
              ]
            },
            "label": {
              "description": "Popisek číselníkové hodnoty z CRM",
              "type": "string",
              "examples": [
                "Aktivní",
                "Neaktivní"
              ]
            }
          }
        },
        "anonymized": {
          "description": "Záznam byl anonymizován",
          "type": "boolean"
        },
        "deleted": {
          "description": "Záznam byl smazán",
          "type": "boolean"
        },
        "merged": {
          "description": "Záznam byl sloučen a deaktivován",
          "type": "boolean"
        },
        "masterid": {
          "description": "GUID vítězného záznamu při slučování",
          "type": [
            "string",
            "null"
          ],
          "format": "uuid"
        }
      }
    }
  },
  "definitions": {
    "EntityReference": {
      "type": [
        "object",
        "null"
      ],
      "required": [
        "idValue",
        "idType"
      ],
      "properties": {
        "idValue": {
          "type": "string",
          "format": "uuid",
          "description": "GUID záznamu v CRM."
        },
        "idType": {
          "type": "string",
          "enum": [
            "account",
            "contact",
            "systemuser"
          ],
          "description": "Typ návazného záznamu v CRM."
        },
        "crmId": {
          "type": [
            "string",
            "null"
          ],
          "description": "KLID záznamu, je-li k dispozici."
        },
        "name": {
          "type": [
            "string",
            "null"
          ],
          "description": "Název (label) záznamu v CRM."
        }
      },
      "description": "Informace o návazném záznamu."
    }
  }
}